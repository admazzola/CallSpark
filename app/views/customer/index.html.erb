
<h1>All Customers</h1>



  <div class="table-responsive">
    <table id="maintable" class="table table-bordered table-hover table-striped">
  <thead>
    <tr>
      <th>Name</th>
      <th>Calls in past year</th>    
      <th>Company</th>
      <th>Phone</th>
      <th>Email</th>      
    
    </tr>
  </thead>

  <tbody>
    <% Customer.all.reverse.each do |customer| %>
      <tr>
        <td><%= customer.name %></td>
        
        <td><%= Call.where(customer_id: customer.id).where(created_at: (Time.now - 1.year)..Time.now).length %></td>
        
        
        <td>
        	<%= 
        	if(customer.company != nil)
        	customer.company.name 
        	end
        	%>
        </td>
        
        
        <td><%= customer.phone_number %></td>
        <td><%= customer.email %></td>
      
    
        
      
        
        
        
      </tr>
    <% end %>
  </tbody>
</table>

</div>

<a href="/customer/new">
<button type="button" class="btn btn-success savecall-button col-md-3 col-md-offset-3 ">
	Add a new customer	
</button>
</a>

<script>
	$(document).ready(function() {
    $('#maintable').dataTable();
} );

</script>

